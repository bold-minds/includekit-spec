[
  {
    "name": "minimal-query",
    "shape": {
      "query": {
        "model": "Post"
      }
    },
    "expectedCanonical": "{\"query\":{\"model\":\"Post\"}}",
    "expectedShapeId": "s_adaf8e8a5edf5712775121416d66d915791648c96db3087d88c8ac0fec0e1dad"
  },
  {
    "name": "simple-query-with-filter",
    "shape": {
      "query": {
        "model": "Post",
        "where": {
          "conditions": [
            {
              "field": "published",
              "op": "eq",
              "value": true
            }
          ]
        }
      }
    },
    "expectedCanonical": "{\"query\":{\"model\":\"Post\",\"where\":{\"conditions\":[{\"field\":\"published\",\"op\":\"eq\",\"value\":true}]}}}",
    "expectedShapeId": "s_1c3bf8a409e0a58c84a612da6107ae81c894fd4d47711d4bab5edc4683d7debf"
  },
  {
    "name": "with-order-and-limit",
    "shape": {
      "query": {
        "limit": 10,
        "model": "Post",
        "order_by": [
          {
            "descending": true,
            "field": "createdAt"
          }
        ]
      }
    },
    "expectedCanonical": "{\"query\":{\"limit\":10,\"model\":\"Post\",\"order_by\":[{\"descending\":true,\"field\":\"createdAt\"}]}}",
    "expectedShapeId": "s_8b0a77c92876096c06e0f5519d31f9e037e873c60e437073e54f9df1690b59ba"
  },
  {
    "name": "with-fields-and-distinct",
    "shape": {
      "query": {
        "distinct": [
          "authorId"
        ],
        "fields": [
          "id",
          "title"
        ],
        "model": "Post"
      }
    },
    "expectedCanonical": "{\"query\":{\"distinct\":[\"authorId\"],\"fields\":[\"id\",\"title\"],\"model\":\"Post\"}}",
    "expectedShapeId": "s_f86b481777c8233c429f009344bbc1ed75678fcebd526e165aaf731c2c4a02e1"
  },
  {
    "name": "with-includes",
    "shape": {
      "includes": [
        {
          "query": {
            "fields": [
              "id",
              "title"
            ],
            "model": "posts"
          }
        }
      ],
      "query": {
        "model": "User"
      }
    },
    "expectedCanonical": "{\"includes\":[{\"query\":{\"fields\":[\"id\",\"title\"],\"model\":\"posts\"}}],\"query\":{\"model\":\"User\"}}",
    "expectedShapeId": "s_1981c993aec073ec26bc55ff6ff86b0db87f7be898e7d3984df8fdbb5d2a1752"
  },
  {
    "name": "with-nested-includes",
    "shape": {
      "includes": [
        {
          "includes": [
            {
              "query": {
                "limit": 5,
                "model": "comments"
              }
            }
          ],
          "query": {
            "model": "posts"
          }
        }
      ],
      "query": {
        "model": "User"
      }
    },
    "expectedCanonical": "{\"includes\":[{\"includes\":[{\"query\":{\"limit\":5,\"model\":\"comments\"}}],\"query\":{\"model\":\"posts\"}}],\"query\":{\"model\":\"User\"}}",
    "expectedShapeId": "s_915637918216c505fd4f8858e65097ed089a68dd424904ebfed447cd36b466c5"
  },
  {
    "name": "with-relation-filter",
    "shape": {
      "includes": [
        {
          "kind": "some",
          "query": {
            "model": "posts",
            "where": {
              "conditions": [
                {
                  "field": "published",
                  "op": "eq",
                  "value": true
                }
              ]
            }
          }
        }
      ],
      "query": {
        "model": "User"
      }
    },
    "expectedCanonical": "{\"includes\":[{\"kind\":\"some\",\"query\":{\"model\":\"posts\",\"where\":{\"conditions\":[{\"field\":\"published\",\"op\":\"eq\",\"value\":true}]}}}],\"query\":{\"model\":\"User\"}}",
    "expectedShapeId": "s_2d1296093865912984546b940417ef4b2cea9abb9f44682abf48f7689271bb4c"
  },
  {
    "name": "with-pagination",
    "shape": {
      "pagination": {
        "after": "eyJpZCI6InBvc3RfMTIzIn0=",
        "first": 20
      },
      "query": {
        "model": "Post",
        "order_by": [
          {
            "descending": true,
            "field": "createdAt"
          },
          {
            "field": "id"
          }
        ]
      }
    },
    "expectedCanonical": "{\"pagination\":{\"after\":\"eyJpZCI6InBvc3RfMTIzIn0=\",\"first\":20},\"query\":{\"model\":\"Post\",\"order_by\":[{\"descending\":true,\"field\":\"createdAt\"},{\"field\":\"id\"}]}}",
    "expectedShapeId": "s_a772b0b7abc9254e4fcd5bb323d21cbc5f2871f385c202243f7d74aacbb1cc3d"
  },
  {
    "name": "complex-filter",
    "shape": {
      "query": {
        "model": "Post",
        "where": {
          "and": [
            {
              "conditions": [
                {
                  "field": "published",
                  "op": "eq",
                  "value": true
                }
              ]
            },
            {
              "or": [
                {
                  "conditions": [
                    {
                      "field": "featured",
                      "op": "eq",
                      "value": true
                    }
                  ]
                },
                {
                  "conditions": [
                    {
                      "field": "views",
                      "op": "gte",
                      "value": 100
                    }
                  ]
                }
              ]
            }
          ]
        }
      }
    },
    "expectedCanonical": "{\"query\":{\"model\":\"Post\",\"where\":{\"and\":[{\"conditions\":[{\"field\":\"published\",\"op\":\"eq\",\"value\":true}]},{\"or\":[{\"conditions\":[{\"field\":\"featured\",\"op\":\"eq\",\"value\":true}]},{\"conditions\":[{\"field\":\"views\",\"op\":\"gte\",\"value\":100}]}]}]}}}",
    "expectedShapeId": "s_a1f1b2ade7627f2d55d7e92ee7a45bf917106ddd634daccb35a20d9ddd1c8d7a"
  },
  {
    "name": "with-group-by-having",
    "shape": {
      "group_by": [
        "authorId"
      ],
      "having": {
        "conditions": [
          {
            "field": "count",
            "op": "gt",
            "value": 5
          }
        ]
      },
      "query": {
        "fields": [
          "authorId",
          "COUNT(*) as count"
        ],
        "model": "Post"
      }
    },
    "expectedCanonical": "{\"group_by\":[\"authorId\"],\"having\":{\"conditions\":[{\"field\":\"count\",\"op\":\"gt\",\"value\":5}]},\"query\":{\"fields\":[\"authorId\",\"COUNT(*) as count\"],\"model\":\"Post\"}}",
    "expectedShapeId": "s_60131a5bcfc2026fa3a3472103981e3f92c25a11b17cf7498666e81dbf11ebc7"
  }
]